"use strict";(self.webpackChunkreact_native_android_widget_docs=self.webpackChunkreact_native_android_widget_docs||[]).push([[9990],{5733:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>a,default:()=>g,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var d=n(5893),t=n(1151);const r={sidebar_position:4},a="Register widget",s={id:"tutorial/register-widget",title:"Register widget",description:"In order to register our widget so that it can be selected from the launchers widget picker, we need to tell the android app some information about the widget.",source:"@site/docs/tutorial/register-widget.md",sourceDirName:"tutorial",slug:"/tutorial/register-widget",permalink:"/react-native-android-widget/docs/tutorial/register-widget",draft:!1,unlisted:!1,editUrl:"https://github.com/sAleksovski/react-native-android-widget/tree/master/docs/docs/tutorial/register-widget.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"default",previous:{title:"Register task handler",permalink:"/react-native-android-widget/docs/tutorial/register-task-handler"},next:{title:"Register widget in Expo",permalink:"/react-native-android-widget/docs/tutorial/register-widget-expo"}},o={},l=[{value:"Add a widget provider class",id:"add-a-widget-provider-class",level:2},{value:"Create widget preview image",id:"create-widget-preview-image",level:2},{value:"Add widget description string (Optional)",id:"add-widget-description-string-optional",level:2},{value:"Add a widget provider xml file",id:"add-a-widget-provider-xml-file",level:2},{value:"Add services in AndroidManifest.xml",id:"add-services-in-androidmanifestxml",level:2},{value:"Add widget receiver in AndroidManifest.xml",id:"add-widget-receiver-in-androidmanifestxml",level:2},{value:"Add custom fonts used in widgets",id:"add-custom-fonts-used-in-widgets",level:2}];function c(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.h1,{id:"register-widget",children:"Register widget"}),"\n",(0,d.jsx)(i.p,{children:"In order to register our widget so that it can be selected from the launchers widget picker, we need to tell the android app some information about the widget."}),"\n",(0,d.jsx)(i.h2,{id:"add-a-widget-provider-class",children:"Add a widget provider class"}),"\n",(0,d.jsxs)(i.p,{children:["Create a new package ",(0,d.jsx)(i.code,{children:"widget"})," in the native android app. Inside it create a class ",(0,d.jsx)(i.code,{children:"Hello.java"})]}),"\n",(0,d.jsx)(i.pre,{children:(0,d.jsx)(i.code,{className:"language-java",metastring:'title="android/app/src/main/java/com/yourapppackage/widget/Hello.java"',children:"package com.yourapppackage.widget;\n\nimport com.reactnativeandroidwidget.RNWidgetProvider;\n\npublic class Hello extends RNWidgetProvider {\n}\n"})}),"\n",(0,d.jsxs)(i.p,{children:["The class ",(0,d.jsx)(i.strong,{children:"name"})," will be used to reference our widget."]}),"\n",(0,d.jsx)(i.h2,{id:"create-widget-preview-image",children:"Create widget preview image"}),"\n",(0,d.jsx)(i.p,{children:"When the android launcher shows the widget select popup, we can show a screenshot of our widget to give the user an idea what the widget looks like."}),"\n",(0,d.jsxs)(i.p,{children:["Take a screenshot of the widget, and place it inside ",(0,d.jsx)(i.code,{children:"android/app/src/main/res/drawable/hello_preview.png"})]}),"\n",(0,d.jsx)("pre",{children:"android/app/src/main/res/drawable/hello_preview.png"}),"\n",(0,d.jsx)(i.p,{children:(0,d.jsx)(i.img,{alt:"Hello Widget Preview",src:n(6945).Z+"",width:"327",height:"208"})}),"\n",(0,d.jsx)(i.h2,{id:"add-widget-description-string-optional",children:"Add widget description string (Optional)"}),"\n",(0,d.jsxs)(i.p,{children:["When the android launcher shows the widget select popup, under the name of the widget it can show an optional description about the widget. If we want to show a description for our widget, we need to add a description string in ",(0,d.jsx)(i.code,{children:"strings.xml"})]}),"\n",(0,d.jsx)(i.pre,{children:(0,d.jsx)(i.code,{className:"language-xml",metastring:'title="android/app/src/main/res/values/strings.xml"',children:'<?xml version="1.0" encoding="utf-8"?>\n<resources>\n    <string name="app_name">My App Name</string>\n    <string name="widget_hello_description" translatable="false">This is my first widget</string>\n</resources>\n'})}),"\n",(0,d.jsx)(i.h2,{id:"add-a-widget-provider-xml-file",children:"Add a widget provider xml file"}),"\n",(0,d.jsx)(i.p,{children:"Create a new xml file in the resources directory containing the details about the widget."}),"\n",(0,d.jsx)(i.pre,{children:(0,d.jsx)(i.code,{className:"language-xml",metastring:'title="android/app/src/main/res/xml/widgetprovider_hello.xml"',children:'<?xml version="1.0" encoding="utf-8"?>\n<appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android"\n    android:minWidth="320dp"\n    android:minHeight="120dp"\n\n    android:updatePeriodMillis="0"\n\n    android:initialLayout="@layout/rn_widget"\n\n    android:previewImage="@drawable/hello_preview"\n    android:description="@string/widget_hello_description"\n\n    android:resizeMode="none"\n\n    android:widgetCategory="home_screen">\n</appwidget-provider>\n'})}),"\n",(0,d.jsxs)(i.ul,{children:["\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"android:updatePeriodMillis"})," How often, in milliseconds, that this AppWidget wants to be updated. The task handler will be called with ",(0,d.jsx)(i.code,{children:"widgetAction = 'UPDATE_WIDGET'"}),". See the official docs ",(0,d.jsx)(i.a,{href:"https://developer.android.com/reference/android/appwidget/AppWidgetProviderInfo.html#updatePeriodMillis",children:"here"})]}),"\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"android:previewImage"})," should reference the preview image we added previously"]}),"\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"android:description"})," can be added or not, depending on if we added a description in the previous step"]}),"\n"]}),"\n",(0,d.jsx)(i.h2,{id:"add-services-in-androidmanifestxml",children:"Add services in AndroidManifest.xml"}),"\n",(0,d.jsxs)(i.p,{children:["In order to use the ",(0,d.jsx)(i.a,{href:"/react-native-android-widget/docs/primitives/list-widget",children:"ListWidget"})," we need to add a ",(0,d.jsx)(i.code,{children:"RNWidgetCollectionService"})," service."]}),"\n",(0,d.jsxs)(i.p,{children:["Under the application section in the manifest, add a new ",(0,d.jsx)(i.code,{children:"RNWidgetCollectionService"})," service. This service will be shared between all widgets, so it needs to be added only once."]}),"\n",(0,d.jsx)(i.pre,{children:(0,d.jsx)(i.code,{className:"language-xml",metastring:'title="android/app/src/main/AndroidManifest.xml"',children:'<manifest ...>\n  ...\n  <application\n      android:name=".MainApplication"\n      ...>\n\n      <activity\n          android:name=".MainActivity"\n          ...>\n      </activity>\n\n      <service\n          android:name="com.reactnativeandroidwidget.RNWidgetCollectionService"\n          android:permission="android.permission.BIND_REMOTEVIEWS" />\n  </application>\n</manifest>\n'})}),"\n",(0,d.jsx)(i.h2,{id:"add-widget-receiver-in-androidmanifestxml",children:"Add widget receiver in AndroidManifest.xml"}),"\n",(0,d.jsx)(i.p,{children:"Finally, we need to add a receiver for our widget, that will receive system events (like widget added, widget resized...)"}),"\n",(0,d.jsxs)(i.p,{children:["In ",(0,d.jsx)(i.code,{children:"AndroidManifest.xml"}),", add a receiver for the widget"]}),"\n",(0,d.jsx)(i.pre,{children:(0,d.jsx)(i.code,{className:"language-xml",metastring:'title="android/app/src/main/AndroidManifest.xml"',children:'<manifest ...>\n  ...\n  <application\n      android:name=".MainApplication"\n      ...>\n\n      <activity\n          android:name=".MainActivity"\n          ...>\n      </activity>\n\n      <service\n          android:name="com.reactnativeandroidwidget.RNWidgetCollectionService"\n          ... />\n\n      <receiver\n          android:name=".widget.Hello"\n          android:exported="false"\n          android:label="My Hello Widget">\n          <intent-filter>\n              <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />\n              <action android:name="com.yourapppackage.WIDGET_CLICK" />\n          </intent-filter>\n          <meta-data\n              android:name="android.appwidget.provider"\n              android:resource="@xml/widgetprovider_hello" />\n      </receiver>\n  </application>\n</manifest>\n'})}),"\n",(0,d.jsx)(i.p,{children:"For the receiver"}),"\n",(0,d.jsxs)(i.ul,{children:["\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"android:name"})," myst be ",(0,d.jsx)(i.code,{children:".widget.WidgetName"})," (same as the Java class extending ",(0,d.jsx)(i.code,{children:"RNWidgetProvider"}),")"]}),"\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"android:label"})," will be shown in the widget picker"]}),"\n"]}),"\n",(0,d.jsx)(i.h2,{id:"add-custom-fonts-used-in-widgets",children:"Add custom fonts used in widgets"}),"\n",(0,d.jsxs)(i.p,{children:["If we used a custom font in our widget, we must copy the font file(s) to ",(0,d.jsx)(i.code,{children:"android/app/src/main/assets/fonts"}),". The ",(0,d.jsx)(i.code,{children:"fontFamily"})," style prop will match the file by name."]}),"\n",(0,d.jsxs)(i.p,{children:["For example, ",(0,d.jsx)(i.code,{children:"android/app/src/main/assets/fonts/Inter.ttf"})]})]})}function g(e={}){const{wrapper:i}={...(0,t.a)(),...e.components};return i?(0,d.jsx)(i,{...e,children:(0,d.jsx)(c,{...e})}):c(e)}},6945:(e,i,n)=>{n.d(i,{Z:()=>d});const d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUcAAADQCAYAAACUXaMkAAAABHNCSVQICAgIfAhkiAAACTdJREFUeJzt3UtoXAUbgOFvJslMc/FSFItCK1YqUhAiukh0YV0o1p3QhZeVgiAiuhJERJGibkSxbisKgghqiYvWhYIomjYgqLgRrCItKO1CzMUkc0nmX0iHhn7NP5PMJBn7PBA4J+cyX6F9OWfmJC3MzMw0AoAVips9AMBWJI4ACXEESIgjQEIcARLiCJDo7/YLFAqFbr8EcIlqNLr3JGLH41gul6NUKnX6tACrqlarUalUOna+jsSxUCjE0NBQFIvu0oHNUSqVolQqxfLycszPz6/7qnLdcXSlCGwlxWIxRkZG1n0lua5LveHhYWEEtqRSqRTDw8NrPn7NcRweHnYbDWxpxWJxzYFcU90GBweFEegJxWIxBgcH2z+u3QMGBgaiv7/rTwABdEx/f3/b3Wo7jtu2bWv3EIBN1+7VY1txLJfLbZ0cYCtpp2FtxdEn00Ava6dhPlUBSLQcR+81Av8Frbas5Tj6hBr4L2i1ZS3H0W/XAf4LWm2Z9xwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCMxPj4eY2NjMTY2FsePH2/5uMnJyeZxY2NjXZvvjz/+WPV1Dh482Nz23HPPdW0OLi39mz0Am29qaioajUZERExPT7d83PT0dExNTXVrrKZKpbLq6/z222/N7dddd13X5+HS4MoRICGOAAlxBEh4z5ENV6vVYmlpKfr6+mJgYGBTZlheXo56vR7Ly8vR398f/f3+KbCSK0c2zPj4eJRKpSiVSjE4OBilUikGBgbijjvu2LAZfvnll7jiiiuir68vyuVyDA4OxsDAQAwNDcWLL764YXOw9YkjXff5559HoVCIEydORK1WW7GtXq/H8ePHo6+vL7744ouuznHnnXfGTTfdFDMzMxdsW1hYiIMHD8bQ0FAsLCx0dQ56g3sJumpycjLuvffe5nqhUIgnn3wy9u7dGz///HO8/fbbEfHvbe4999wTp06dip07d3Z8jltvvTV++OGH5nq5XI4nnngitm/fHhMTE81tCwsLcfnll18QcS494khX3X333c3lAwcOxEcffbRi+6FDh+LAgQPxySefRETErl27ms9cdsqRI0dWhPGtt96Kp59+urn+0ksvxenTp2P37t1Rr9ejXq/Hjh074syZMx2dg97itpoV9u/fH4VCoaWv+++/f9Vzvf7661GtViMiYs+ePReE8ZyPP/44SqVSc/2nn37q3B8oIh5++OHm8iOPPLIijOfs3Lkzfvzxx+b62bNn4++//+7oHPQWcaRr3njjjebyxMTEqvu+//77zeU333yzYzPMz89HpVJprr/zzjsX3Xfv3r2xffv25vqzzz7bsTnoPeJI1/z555/N5ZtvvjmWl5cv+nX77bc393333Xc7NsOnn37aXC4UClEul1fd//xPrA8fPtyxOeg94sgKx44dWzVi538dPXq05fP29fWt+nXjjTd25c/z7bffNpfPf//zYsbHx7syB73HBzKscO79xFb33erOf//ymmuu+b/7j4yMdHMceog4siG+/PLLTXnd0dHR+PrrryNi5W3+xWTPQHJpEkc2xL59+zblde+66644dOhQRER89dVX/3f/b775ptsj0SO850jX7Nixo7l87NixTZnhvvvuW7E+Nze36v6vvPJKc/mZZ57pykz0BnGka5566qnm8mOPPbbqvo8//ngUi8V49NFHY3JysmMzDA0NxbZt25rrDz744EX3nZqaWvHLfl999dWOzUHvEUe65oUXXohi8d+/YmfOnIldu3bF0tLSBftNTEzE4cOHo9FoxHvvvdfxD3o+++yz5vLRo0fj+eefv2CfU6dOrfgvGK6++uoYGhrq6Bz0FnGkq87/sb3Tp09Hf39/XHnllfHQQw/FDTfcEIODg/HAAw809xkeHu744zT79u2L0dHR5vprr70WAwMDcdVVV8WePXtiZGQkrr/++ub2YrEYZ8+e7egM9B5xpKtuueWW+O6771Z8b3p6Oj788MP4/fffY3Fxsfn93bt3x+zsbFfm+P7771dEuF6vx19//RUnT56Mf/75p/n94eHhmJ2d7YnHlOgucaTrbrvttqjVavHyyy+n20dHR+PEiRPx66+/djVKR44ciZMnT8b+/fsv2HbttdfGBx98EHNzc26niYiIwszMTEu/AuWyyy7r9iwAG6KVOxRXjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgETLcWw0Gt2cA2BDtNqyluNYq9XWPAzAVtFqy1qOY6VSWfMwAFtFqy1r6z1Ht9ZAL2unYW3F0dUj0MsWFxdb3retONZqNVePQE9qNBpRr9db3r/tR3nm5+fbPQRg07XbrrbjuLy87PYa6CmVSiWWl5fbOmZND4FXq1WP9gA9oVarRbVabfu4Nf+EzOLioitIYEurVCptfQhzvnX9+GC1Wo25ubn1nAKgK+bm5tZ0xXhO/3oHaDQaMTs7G6VSKcrl8npPB7AulUplXVE8Z91xPKdarUa1Wo2+vr4olUrR39+xUwOsql6vR7VajaWlpY6ds+MFW1paioWFhU6fFmBD+ZVlAAlxBEiII0BCHAES4giQEEeAhDgCJP4H6/Y8YKqxICUAAAAASUVORK5CYII="},1151:(e,i,n)=>{n.d(i,{Z:()=>s,a:()=>a});var d=n(7294);const t={},r=d.createContext(t);function a(e){const i=d.useContext(r);return d.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function s(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),d.createElement(r.Provider,{value:i},e.children)}}}]);