"use strict";(self.webpackChunkreact_native_android_widget_docs=self.webpackChunkreact_native_android_widget_docs||[]).push([[9990],{3905:(e,i,t)=>{t.d(i,{Zo:()=>p,kt:()=>m});var n=t(7294);function r(e,i,t){return i in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t,e}function a(e,i){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);i&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var t=null!=arguments[i]?arguments[i]:{};i%2?a(Object(t),!0).forEach((function(i){r(e,i,t[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))}))}return e}function o(e,i){if(null==e)return{};var t,n,r=function(e,i){if(null==e)return{};var t,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],i.indexOf(t)>=0||(r[t]=e[t]);return r}(e,i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],i.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=n.createContext({}),s=function(e){var i=n.useContext(l),t=i;return e&&(t="function"==typeof e?e(i):d(d({},i),e)),t},p=function(e){var i=s(e.components);return n.createElement(l.Provider,{value:i},e.children)},c={inlineCode:"code",wrapper:function(e){var i=e.children;return n.createElement(n.Fragment,{},i)}},g=n.forwardRef((function(e,i){var t=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),g=s(t),m=r,u=g["".concat(l,".").concat(m)]||g[m]||c[m]||a;return t?n.createElement(u,d(d({ref:i},p),{},{components:t})):n.createElement(u,d({ref:i},p))}));function m(e,i){var t=arguments,r=i&&i.mdxType;if("string"==typeof e||r){var a=t.length,d=new Array(a);d[0]=g;var o={};for(var l in i)hasOwnProperty.call(i,l)&&(o[l]=i[l]);o.originalType=e,o.mdxType="string"==typeof e?e:r,d[1]=o;for(var s=2;s<a;s++)d[s]=t[s];return n.createElement.apply(null,d)}return n.createElement.apply(null,t)}g.displayName="MDXCreateElement"},5849:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>l,contentTitle:()=>d,default:()=>c,frontMatter:()=>a,metadata:()=>o,toc:()=>s});var n=t(7462),r=(t(7294),t(3905));const a={sidebar_position:4},d="Register widget",o={unversionedId:"tutorial/register-widget",id:"tutorial/register-widget",title:"Register widget",description:"In order to register our widget so that it can be selected from the launchers widget picker, we need to tell the android app some information about the widget.",source:"@site/docs/tutorial/register-widget.md",sourceDirName:"tutorial",slug:"/tutorial/register-widget",permalink:"/react-native-android-widget/docs/tutorial/register-widget",draft:!1,editUrl:"https://github.com/sAleksovski/react-native-android-widget/tree/master/docs/docs/tutorial/register-widget.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"default",previous:{title:"Register task handler",permalink:"/react-native-android-widget/docs/tutorial/register-task-handler"},next:{title:"Register widget in Expo",permalink:"/react-native-android-widget/docs/tutorial/register-widget-expo"}},l={},s=[{value:"Add a widget provider class",id:"add-a-widget-provider-class",level:2},{value:"Create widget preview image",id:"create-widget-preview-image",level:2},{value:"Add widget description string (Optional)",id:"add-widget-description-string-optional",level:2},{value:"Add a widget provider xml file",id:"add-a-widget-provider-xml-file",level:2},{value:"Add services in AndroidManifest.xml",id:"add-services-in-androidmanifestxml",level:2},{value:"Add widget receiver in AndroidManifest.xml",id:"add-widget-receiver-in-androidmanifestxml",level:2},{value:"Add custom fonts used in widgets",id:"add-custom-fonts-used-in-widgets",level:2}],p={toc:s};function c(e){let{components:i,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},p,a,{components:i,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"register-widget"},"Register widget"),(0,r.kt)("p",null,"In order to register our widget so that it can be selected from the launchers widget picker, we need to tell the android app some information about the widget."),(0,r.kt)("h2",{id:"add-a-widget-provider-class"},"Add a widget provider class"),(0,r.kt)("p",null,"Create a new package ",(0,r.kt)("inlineCode",{parentName:"p"},"widget")," in the native android app. Inside it create a class ",(0,r.kt)("inlineCode",{parentName:"p"},"Hello.java")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java",metastring:'title="android/app/src/main/java/com/yourapppackage/widget/Hello.java"',title:'"android/app/src/main/java/com/yourapppackage/widget/Hello.java"'},"package com.yourapppackage.widget;\n\nimport com.reactnativeandroidwidget.RNWidgetProvider;\n\npublic class Hello extends RNWidgetProvider {\n}\n")),(0,r.kt)("p",null,"The class ",(0,r.kt)("strong",{parentName:"p"},"name")," will be used to reference our widget."),(0,r.kt)("h2",{id:"create-widget-preview-image"},"Create widget preview image"),(0,r.kt)("p",null,"When the android launcher shows the widget select popup, we can show a screenshot of our widget to give the user an idea what the widget looks like."),(0,r.kt)("p",null,"Take a screenshot of the widget, and place it inside ",(0,r.kt)("inlineCode",{parentName:"p"},"android/app/src/main/res/drawable/hello_preview.png")),(0,r.kt)("pre",null,"android/app/src/main/res/drawable/hello_preview.png"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Hello Widget Preview",src:t(6945).Z,width:"327",height:"208"})),(0,r.kt)("h2",{id:"add-widget-description-string-optional"},"Add widget description string (Optional)"),(0,r.kt)("p",null,"When the android launcher shows the widget select popup, under the name of the widget it can show an optional description about the widget. If we want to show a description for our widget, we need to add a description string in ",(0,r.kt)("inlineCode",{parentName:"p"},"strings.xml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="android/app/src/main/res/values/strings.xml"',title:'"android/app/src/main/res/values/strings.xml"'},'<?xml version="1.0" encoding="utf-8"?>\n<resources>\n    <string name="app_name">My App Name</string>\n    <string name="widget_hello_description" translatable="false">This is my first widget</string>\n</resources>\n')),(0,r.kt)("h2",{id:"add-a-widget-provider-xml-file"},"Add a widget provider xml file"),(0,r.kt)("p",null,"Create a new xml file in the resources directory containing the details about the widget."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="android/app/src/main/res/xml/widgetprovider_hello.xml"',title:'"android/app/src/main/res/xml/widgetprovider_hello.xml"'},'<?xml version="1.0" encoding="utf-8"?>\n<appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android"\n    android:minWidth="320dp"\n    android:minHeight="120dp"\n\n    android:updatePeriodMillis="0"\n\n    android:initialLayout="@layout/rn_widget"\n\n    android:previewImage="@drawable/hello_preview"\n    android:description="@string/widget_hello_description"\n\n    android:resizeMode="none"\n\n    android:widgetCategory="home_screen">\n</appwidget-provider>\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"android:updatePeriodMillis")," How often, in milliseconds, that this AppWidget wants to be updated. The task handler will be called with ",(0,r.kt)("inlineCode",{parentName:"li"},"widgetAction = 'UPDATE_WIDGET'"),". See the official docs ",(0,r.kt)("a",{parentName:"li",href:"https://developer.android.com/reference/android/appwidget/AppWidgetProviderInfo.html#updatePeriodMillis"},"here")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"android:previewImage")," should reference the preview image we added previously"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"android:description")," can be added or not, depending on if we added a description in the previous step")),(0,r.kt)("h2",{id:"add-services-in-androidmanifestxml"},"Add services in AndroidManifest.xml"),(0,r.kt)("p",null,"In order to use the ",(0,r.kt)("a",{parentName:"p",href:"/react-native-android-widget/docs/primitives/list-widget"},"ListWidget")," we need to add a ",(0,r.kt)("inlineCode",{parentName:"p"},"RNWidgetCollectionService")," service."),(0,r.kt)("p",null,"Under the application section in the manifest, add a new ",(0,r.kt)("inlineCode",{parentName:"p"},"RNWidgetCollectionService")," service. This service will be shared between all widgets, so it needs to be added only once."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="android/app/src/main/AndroidManifest.xml"',title:'"android/app/src/main/AndroidManifest.xml"'},'<manifest ...>\n  ...\n  <application\n      android:name=".MainApplication"\n      ...>\n\n      <activity\n          android:name=".MainActivity"\n          ...>\n      </activity>\n\n      <service\n          android:name="com.reactnativeandroidwidget.RNWidgetCollectionService"\n          android:permission="android.permission.BIND_REMOTEVIEWS" />\n  </application>\n</manifest>\n')),(0,r.kt)("h2",{id:"add-widget-receiver-in-androidmanifestxml"},"Add widget receiver in AndroidManifest.xml"),(0,r.kt)("p",null,"Finally, we need to add a receiver for our widget, that will receive system events (like widget added, widget resized...)"),(0,r.kt)("p",null,"In ",(0,r.kt)("inlineCode",{parentName:"p"},"AndroidManifest.xml"),", add a receiver for the widget"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="android/app/src/main/AndroidManifest.xml"',title:'"android/app/src/main/AndroidManifest.xml"'},'<manifest ...>\n  ...\n  <application\n      android:name=".MainApplication"\n      ...>\n\n      <activity\n          android:name=".MainActivity"\n          ...>\n      </activity>\n\n      <service\n          android:name="com.reactnativeandroidwidget.RNWidgetCollectionService"\n          ... />\n\n      <receiver\n          android:name=".widget.Hello"\n          android:exported="false"\n          android:label="My Hello Widget">\n          <intent-filter>\n              <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />\n              <action android:name="com.yourapppackage.WIDGET_CLICK" />\n          </intent-filter>\n          <meta-data\n              android:name="android.appwidget.provider"\n              android:resource="@xml/widgetprovider_hello" />\n      </receiver>\n  </application>\n</manifest>\n')),(0,r.kt)("p",null,"For the receiver"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"android:name")," myst be ",(0,r.kt)("inlineCode",{parentName:"li"},".widget.WidgetName")," (same as the Java class extending ",(0,r.kt)("inlineCode",{parentName:"li"},"RNWidgetProvider"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"android:label")," will be shown in the widget picker")),(0,r.kt)("h2",{id:"add-custom-fonts-used-in-widgets"},"Add custom fonts used in widgets"),(0,r.kt)("p",null,"If we used a custom font in our widget, we must copy the font file(s) to ",(0,r.kt)("inlineCode",{parentName:"p"},"android/app/src/main/assets/fonts"),". The ",(0,r.kt)("inlineCode",{parentName:"p"},"fontFamily")," style prop will match the file by name."),(0,r.kt)("p",null,"For example, ",(0,r.kt)("inlineCode",{parentName:"p"},"android/app/src/main/assets/fonts/Inter.ttf")))}c.isMDXComponent=!0},6945:(e,i,t)=>{t.d(i,{Z:()=>n});const n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUcAAADQCAYAAACUXaMkAAAABHNCSVQICAgIfAhkiAAACTdJREFUeJzt3UtoXAUbgOFvJslMc/FSFItCK1YqUhAiukh0YV0o1p3QhZeVgiAiuhJERJGibkSxbisKgghqiYvWhYIomjYgqLgRrCItKO1CzMUkc0nmX0iHhn7NP5PMJBn7PBA4J+cyX6F9OWfmJC3MzMw0AoAVips9AMBWJI4ACXEESIgjQEIcARLiCJDo7/YLFAqFbr8EcIlqNLr3JGLH41gul6NUKnX6tACrqlarUalUOna+jsSxUCjE0NBQFIvu0oHNUSqVolQqxfLycszPz6/7qnLdcXSlCGwlxWIxRkZG1n0lua5LveHhYWEEtqRSqRTDw8NrPn7NcRweHnYbDWxpxWJxzYFcU90GBweFEegJxWIxBgcH2z+u3QMGBgaiv7/rTwABdEx/f3/b3Wo7jtu2bWv3EIBN1+7VY1txLJfLbZ0cYCtpp2FtxdEn00Ava6dhPlUBSLQcR+81Av8Frbas5Tj6hBr4L2i1ZS3H0W/XAf4LWm2Z9xwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCMxPj4eY2NjMTY2FsePH2/5uMnJyeZxY2NjXZvvjz/+WPV1Dh482Nz23HPPdW0OLi39mz0Am29qaioajUZERExPT7d83PT0dExNTXVrrKZKpbLq6/z222/N7dddd13X5+HS4MoRICGOAAlxBEh4z5ENV6vVYmlpKfr6+mJgYGBTZlheXo56vR7Ly8vR398f/f3+KbCSK0c2zPj4eJRKpSiVSjE4OBilUikGBgbijjvu2LAZfvnll7jiiiuir68vyuVyDA4OxsDAQAwNDcWLL764YXOw9YkjXff5559HoVCIEydORK1WW7GtXq/H8ePHo6+vL7744ouuznHnnXfGTTfdFDMzMxdsW1hYiIMHD8bQ0FAsLCx0dQ56g3sJumpycjLuvffe5nqhUIgnn3wy9u7dGz///HO8/fbbEfHvbe4999wTp06dip07d3Z8jltvvTV++OGH5nq5XI4nnngitm/fHhMTE81tCwsLcfnll18QcS494khX3X333c3lAwcOxEcffbRi+6FDh+LAgQPxySefRETErl27ms9cdsqRI0dWhPGtt96Kp59+urn+0ksvxenTp2P37t1Rr9ejXq/Hjh074syZMx2dg97itpoV9u/fH4VCoaWv+++/f9Vzvf7661GtViMiYs+ePReE8ZyPP/44SqVSc/2nn37q3B8oIh5++OHm8iOPPLIijOfs3Lkzfvzxx+b62bNn4++//+7oHPQWcaRr3njjjebyxMTEqvu+//77zeU333yzYzPMz89HpVJprr/zzjsX3Xfv3r2xffv25vqzzz7bsTnoPeJI1/z555/N5ZtvvjmWl5cv+nX77bc393333Xc7NsOnn37aXC4UClEul1fd//xPrA8fPtyxOeg94sgKx44dWzVi538dPXq05fP29fWt+nXjjTd25c/z7bffNpfPf//zYsbHx7syB73HBzKscO79xFb33erOf//ymmuu+b/7j4yMdHMceog4siG+/PLLTXnd0dHR+PrrryNi5W3+xWTPQHJpEkc2xL59+zblde+66644dOhQRER89dVX/3f/b775ptsj0SO850jX7Nixo7l87NixTZnhvvvuW7E+Nze36v6vvPJKc/mZZ57pykz0BnGka5566qnm8mOPPbbqvo8//ngUi8V49NFHY3JysmMzDA0NxbZt25rrDz744EX3nZqaWvHLfl999dWOzUHvEUe65oUXXohi8d+/YmfOnIldu3bF0tLSBftNTEzE4cOHo9FoxHvvvdfxD3o+++yz5vLRo0fj+eefv2CfU6dOrfgvGK6++uoYGhrq6Bz0FnGkq87/sb3Tp09Hf39/XHnllfHQQw/FDTfcEIODg/HAAw809xkeHu744zT79u2L0dHR5vprr70WAwMDcdVVV8WePXtiZGQkrr/++ub2YrEYZ8+e7egM9B5xpKtuueWW+O6771Z8b3p6Oj788MP4/fffY3Fxsfn93bt3x+zsbFfm+P7771dEuF6vx19//RUnT56Mf/75p/n94eHhmJ2d7YnHlOgucaTrbrvttqjVavHyyy+n20dHR+PEiRPx66+/djVKR44ciZMnT8b+/fsv2HbttdfGBx98EHNzc26niYiIwszMTEu/AuWyyy7r9iwAG6KVOxRXjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgIQ4AiTEESAhjgAJcQRIiCNAQhwBEuIIkBBHgETLcWw0Gt2cA2BDtNqyluNYq9XWPAzAVtFqy1qOY6VSWfMwAFtFqy1r6z1Ht9ZAL2unYW3F0dUj0MsWFxdb3retONZqNVePQE9qNBpRr9db3r/tR3nm5+fbPQRg07XbrrbjuLy87PYa6CmVSiWWl5fbOmZND4FXq1WP9gA9oVarRbVabfu4Nf+EzOLioitIYEurVCptfQhzvnX9+GC1Wo25ubn1nAKgK+bm5tZ0xXhO/3oHaDQaMTs7G6VSKcrl8npPB7AulUplXVE8Z91xPKdarUa1Wo2+vr4olUrR39+xUwOsql6vR7VajaWlpY6ds+MFW1paioWFhU6fFmBD+ZVlAAlxBEiII0BCHAES4giQEEeAhDgCJP4H6/Y8YKqxICUAAAAASUVORK5CYII="}}]);